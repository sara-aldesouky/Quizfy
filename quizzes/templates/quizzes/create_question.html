{% extends "base.html" %}
{% block title %}Add Question{% endblock %}
{% block content %}
<h1>Add Question</h1>
<p><b>Quiz:</b> {{ quiz.title }} ({{ quiz.code }})</p>

<!-- Question Type Selector -->
<div class="card" style="margin-bottom: 16px;">
  <label style="font-weight: 600; margin-bottom: 12px; display: block;">Select Question Type</label>
  <div class="question-type-tabs">
    <a href="?type=multiple_choice" class="q-type-tab {% if selected_question_type == 'multiple_choice' %}active{% endif %}">
      üìù Multiple Choice
    </a>
    <a href="?type=true_false" class="q-type-tab {% if selected_question_type == 'true_false' %}active{% endif %}">
      ‚úì‚úó True/False
    </a>
    <a href="?type=file_upload" class="q-type-tab {% if selected_question_type == 'file_upload' %}active{% endif %}">
      üìÑ File Upload
    </a>
  </div>
</div>

<form method="post" enctype="multipart/form-data" class="card">
  {% csrf_token %}
  <input type="hidden" name="question_type" value="{{ selected_question_type }}">
  
  <div class="field">
    <label for="id_text">Question Text</label>
    {{ form.text }}
    {% if selected_question_type == 'file_upload' %}
      <small style="color: var(--muted);">Enter instructions for what the student should upload.</small>
    {% endif %}
  </div>
  
  <div class="field">
    <label for="id_image">Question Image (optional)</label>
    {{ form.image }}
  </div>
  
  {% if selected_question_type == 'multiple_choice' %}
    <div class="options-grid">
      <div class="field">
        <label for="id_option1">Option 1</label>
        {{ form.option1 }}
      </div>
      <div class="field">
        <label for="id_option2">Option 2</label>
        {{ form.option2 }}
      </div>
      <div class="field">
        <label for="id_option3">Option 3</label>
        {{ form.option3 }}
      </div>
      <div class="field">
        <label for="id_option4">Option 4</label>
        {{ form.option4 }}
      </div>
    </div>
    
    <div class="field">
      <label for="id_correct_option">Correct Answer</label>
      {{ form.correct_option }}
    </div>
  {% elif selected_question_type == 'true_false' %}
    <!-- True/False -->
    <div class="field">
      <label>Correct Answer</label>
      <div class="tf-options">
        <label class="tf-option">
          <input type="radio" name="correct_option" value="1" {% if form.correct_option.value == 1 or form.correct_option.value == '1' %}checked{% endif %}>
          <span class="tf-label true">‚úì True</span>
        </label>
        <label class="tf-option">
          <input type="radio" name="correct_option" value="2" {% if form.correct_option.value == 2 or form.correct_option.value == '2' %}checked{% endif %}>
          <span class="tf-label false">‚úó False</span>
        </label>
      </div>
    </div>
  {% else %}
    <!-- File Upload - no options needed -->
    <div class="info-box" style="margin: 16px 0;">
      <p style="margin: 0;">üìÑ <b>File Upload Question</b></p>
      <p style="color: var(--muted); margin: 8px 0 0;">
        Students will upload a file (PDF, JPG, PNG) as their answer to this question.
        You will grade their submissions manually.
      </p>
    </div>
  {% endif %}
  
  <div class="actions">
    <button class="btn primary" type="submit">Add Question</button>
    <a class="btn secondary" href="{% url 'teacher_quiz_detail' quiz.id %}">Cancel</a>
  </div>
</form>

<style>
.question-type-tabs {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.q-type-tab {
  padding: 10px 18px;
  border-radius: 8px;
  background: var(--card1, rgba(255,255,255,0.03));
  border: 2px solid var(--border, rgba(255,255,255,0.1));
  color: var(--text);
  text-decoration: none;
  font-weight: 500;
  transition: all 0.2s ease;
}

.q-type-tab:hover {
  border-color: var(--accent, #2563eb);
  background: rgba(37, 99, 235, 0.05);
}

.q-type-tab.active {
  border-color: var(--accent, #2563eb);
  background: rgba(37, 99, 235, 0.15);
  color: #60a5fa;
}

.options-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

@media (max-width: 600px) {
  .options-grid {
    grid-template-columns: 1fr;
  }
}

.tf-options {
  display: flex;
  gap: 16px;
  margin-top: 8px;
}

.tf-option {
  flex: 1;
  cursor: pointer;
}

.tf-option input {
  display: none;
}

.tf-label {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  border-radius: 10px;
  font-weight: 600;
  font-size: 16px;
  transition: all 0.2s ease;
  border: 2px solid var(--border);
}

.tf-label.true {
  background: rgba(16, 185, 129, 0.05);
}

.tf-label.false {
  background: rgba(239, 68, 68, 0.05);
}

.tf-option input:checked + .tf-label.true {
  background: rgba(16, 185, 129, 0.2);
  border-color: #10b981;
  color: #10b981;
}

.tf-option input:checked + .tf-label.false {
  background: rgba(239, 68, 68, 0.2);
  border-color: #ef4444;
  color: #ef4444;
}
</style>
{% endblock %}